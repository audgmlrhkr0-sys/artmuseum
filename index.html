<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>미술관 아카이브 러너</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 게임 시작 화면 -->
    <div id="startScreen" class="start-screen">
        <div class="start-content">
            <h1>미술관 아카이브 러너</h1>
            <p>포스터를 수집하고 챕터를 완료하세요!</p>
            <button id="startBtn" class="start-btn" onclick="beginGame(); return false;">게임 시작</button>
        </div>
    </div>

    <div id="gameContainer" class="hidden">
        <div id="score">점수: 0</div>
        <div id="gameCanvas"></div>
        <div id="gameOver" class="hidden">
            <h2>게임 오버!</h2>
            <p>최종 점수: <span id="finalScore">0</span></p>
            <button id="restartBtn">다시 시작</button>
        </div>
        
        <!-- 모바일 터치 컨트롤 -->
        <div id="mobileControls" class="mobile-controls hidden">
            <!-- 좌측 상단: 방향키 키패드 -->
            <div id="dpad" class="dpad">
                <div class="dpad-grid">
                    <div class="dpad-cell"></div>
                    <button id="btnUp" class="dpad-btn dpad-up">↑</button>
                    <div class="dpad-cell"></div>
                    <button id="btnLeft" class="dpad-btn dpad-left">←</button>
                    <div class="dpad-cell"></div>
                    <button id="btnRight" class="dpad-btn dpad-right">→</button>
                    <div class="dpad-cell"></div>
                    <button id="btnDown" class="dpad-btn dpad-down">↓</button>
                    <div class="dpad-cell"></div>
                </div>
            </div>
            
            <!-- 우측: 점프 및 아이템 줍기 버튼 -->
            <div class="action-buttons">
                <button id="btnJump" class="action-btn jump-btn">점프</button>
                <button id="btnCollect" class="action-btn collect-btn">줍기</button>
            </div>
        </div>
    </div>

    <!-- 포스터 모달 -->
    <div id="posterModal" class="modal hidden">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="posterTitle"></h2>
            <div id="posterImageContainer">
                <img id="posterImage" src="" alt="포스터">
            </div>
            <p id="posterDescription"></p>
            <button id="continueBtn">계속하기</button>
        </div>
    </div>

    <script>
        // 즉시 실행 함수로 beginGame 정의
        function beginGame() {
            console.log('beginGame 호출됨 - 인라인 스크립트');
            
            // 시작 화면 숨기기
            const startScreen = document.getElementById('startScreen');
            if (startScreen) {
                startScreen.classList.add('hidden');
                startScreen.style.display = 'none';
                console.log('시작 화면 숨김');
            }
            
            // 게임 컨테이너 표시
            const gameContainer = document.getElementById('gameContainer');
            if (gameContainer) {
                gameContainer.classList.remove('hidden');
                gameContainer.style.display = 'block';
                console.log('게임 컨테이너 표시');
            }
            
            // 모바일 컨트롤 표시
            const mobileControls = document.getElementById('mobileControls');
            if (mobileControls) {
                mobileControls.classList.remove('hidden');
                mobileControls.style.display = 'block';
                console.log('모바일 컨트롤 표시');
            }
            
            // 전체 화면 시도
            try {
                const element = document.documentElement;
                if (element.requestFullscreen) {
                    element.requestFullscreen().catch(() => {});
                } else if (element.webkitRequestFullscreen) {
                    element.webkitRequestFullscreen();
                } else if (element.mozRequestFullScreen) {
                    element.mozRequestFullScreen();
                } else if (element.msRequestFullscreen) {
                    element.msRequestFullscreen();
                }
            } catch (e) {
                console.log('전체 화면 실패:', e);
            }
            
            // 게임 시작 (main.js의 startGame 함수 호출)
            if (typeof startGame === 'function') {
                console.log('startGame 함수 호출');
                startGame();
            } else {
                console.error('startGame 함수를 찾을 수 없습니다!');
                // 1초 후 다시 시도
                setTimeout(function() {
                    if (typeof startGame === 'function') {
                        startGame();
                    }
                }, 1000);
            }
            
            // 모바일 컨트롤 초기화
            setTimeout(function() {
                if (typeof initMobileControls === 'function') {
                    initMobileControls();
                }
            }, 500);
        }
        
        // 페이지 로드 확인
        console.log('HTML 스크립트 로드됨');
        
        // DOM 로드 후 확인
        window.addEventListener('DOMContentLoaded', function() {
            console.log('DOM 로드 완료');
            const startBtn = document.getElementById('startBtn');
            console.log('시작 버튼 요소:', startBtn);
            
            if (startBtn) {
                startBtn.onclick = function(e) {
                    e.preventDefault();
                    console.log('버튼 클릭 이벤트 발생');
                    beginGame();
                    return false;
                };
                console.log('onclick 이벤트 설정 완료');
            }
        });
    </script>
    <script src="main.js"></script>
</body>
</html>

